<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2017-03-27
 | Rendered using Hippo Forge Maven Skin 1.04.00 based on Apache Maven Fluido Skin
-->
<!--[if lt IE 7]><html id="ie6" xmlns="http://www.w3.org/1999/xhtml"  xml:lang="en" lang="en"><![endif]-->
<!--[if IE 7]><html id="ie7" xmlns="http://www.w3.org/1999/xhtml"  xml:lang="en" lang="en"><![endif]-->
<!--[if IE 8]><html id="ie8" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><![endif]-->
<!--[if IE 9]><html id="ie9" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><![endif]-->
<!--[if !IE]>--><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><!--<![endif]-->

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
                    <meta name="Date-Revision-yyyymmdd" content="20170327"/>
                <meta http-equiv="Content-Language" content="en"/>
        <title>Apache Camel - Hippo Events Support Documentation &#x2013; Camel Repository Scheduler Job Component</title>
    <link rel="stylesheet" href="./css/forge-maven-skin-syntaxhighlighter-1.04.00.min.css"/>
    <link rel="stylesheet" href="./css/forge-maven-skin-1.04.00.min.css"/>
    <link rel="stylesheet" href="./css/site.css"/>
    <link rel="stylesheet" href="./css/print.css" media="print"/>

        
    <script type="text/javascript" src="./js/forge-maven-skin-syntaxhighlighter-1.04.00.min.js"></script>
    <script type="text/javascript" src="./js/forge-maven-skin-1.04.00.min.js"></script>

    
            </head>
    <body>

        
    
    
    <div class="container-fluid">
        <div class="row-fluid">
            <div id="header">
                <div id="logo">
                    <a href="http://www.onehippo.com">
                        <img src="./images/hipposkin/hippo-logo.png" alt="Hippo Logo" />
                    </a>
                </div>

                <h1>
                                            Apache Camel - Hippo Events Support Documentation
                    
                </h1>
                <div class="clearfix"></div>
            </div>
        </div>

        <div class="row-fluid">
            <div id="breadcrumbs" class="clearfix">
                <ul class="breadcrumb">
                                
                                        
                            <li id="publishDate">Last Published: 2017-03-27</li>
                                                                                                                                                </ul>

                <div class="links">
                    <a href="https://www.onehippo.com">Onehippo.com</a>
                    <a href="https://www.onehippo.org">Onehippo.org</a>
                </div>
            </div>
        </div>



            
    <div class="row-fluid">
        <div id="leftColumn" class="span3">
            <div class="well sidebar-nav">
                <ul class="nav nav-list">
                                        <li class="nav-header">Home</li>
                                                           
        <li>
    
                                                <a href="index.html" title="Home">
                    <i class="none"></i>
                Home</a>
                    </li>
                               
        <li>
    
                                                <a href="release-notes.html" title="Release Notes">
                    <i class="none"></i>
                Release Notes</a>
                    </li>
                                                            <li class="nav-header">Usage</li>
                                                           
        <li>
    
                                                <a href="component-hippoevent.html" title="Hippo Event Component">
                    <i class="none"></i>
                Hippo Event Component</a>
                    </li>
                               
        <li class="active">
    
                        <a href="#"><i class="none"></i>Hippo Repository Scheduler Job Component</a>
                </li>
                               
        <li>
    
                                                <a href="util-camelcontextutils.html" title="Utils: CamelContextUtils">
                    <i class="none"></i>
                Utils: CamelContextUtils</a>
                    </li>
                                                            <li class="nav-header">Demo</li>
                                                           
        <li>
    
                                                <a href="aboutdemo.html" title="About Demo Project">
                    <i class="none"></i>
                About Demo Project</a>
                    </li>
                               
        <li>
    
                                                <a href="demo-solr-integration.html" title="Demo 1: Solr Search Engine Integration">
                    <i class="none"></i>
                Demo 1: Solr Search Engine Integration</a>
                    </li>
                               
        <li>
    
                                                <a href="demo-es-integration.html" title="Demo 2: ElasticSearch Engine Integration">
                    <i class="none"></i>
                Demo 2: ElasticSearch Engine Integration</a>
                    </li>
                               
        <li>
    
                                                <a href="demo-integration-activemq.html" title="Demo 3: Running with ActiveMQ">
                    <i class="none"></i>
                Demo 3: Running with ActiveMQ</a>
                    </li>
                                                            <li class="nav-header">Presentations and Blogs</li>
                                                           
        <li>
    
                                                <a href="http://www.onehippo.org/labs/integrating-hippo-cms-with-elastic-search-engine.html" class="externalLink" title="Integrating Hippo CMS with elasticsearch Engine">
                    <i class="none"></i>
                Integrating Hippo CMS with elasticsearch Engine</a>
                    </li>
                                                            <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        <li>
    
                                                <a href="project-info.html" title="Project Information">
                    <i class="icon-chevron-right"></i>
                Project Information</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                                           
        <li>
    
                                                <a href="project-reports.html" title="Project Reports">
                    <i class="icon-chevron-right"></i>
                Project Reports</a>
                                </li>
                        </ul>

                
                <hr class="divider"/>

                <div id="poweredBy">
                                            <div class="clear"></div>
                                            <div class="clear"></div>
                                            <div class="clear"></div>
                                                <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png"/>
        </a>
                            </div>
            </div>
        </div>
    
        
        <div id="bodyColumn"  class="span9" >
                                
            <!-- Copyright 2011 Hippo Licensed under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License. You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0 Unless required by
    applicable law or agreed to in writing, software distributed under
    the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
    OR CONDITIONS OF ANY KIND, either express or implied. See the
    License for the specific language governing permissions and
    limitations under the License. -->
  

    <div class="section">
<h2><a name="Camel_Repository_Scheduler_Job_Component"></a>Camel Repository Scheduler Job Component</h2>
      
<p>
        A default Repository Scheduler Job implementation is provided by
        <a href="apidocs/org/onehippo/forge/camel/scheduling/DefaultCamelRepositoryJob.html">org.onehippo.forge.camel.scheduling.DefaultCamelRepositoryJob</a>.
        This implementation makes it easier to create a <a class="externalLink" href="http://www.onehippo.org/library/concepts/hippo-services/repository-scheduler.html" target="_blank">Hippo Repository Scheduler</a> based task.
      </p>
      
<p>
        This job implementation simply reads the following attributes from <tt>org.onehippo.repository.scheduling.RepositoryJobExecutionContext</tt>,
        find a <tt>CamelContext</tt> and invokes <tt>#sendBody(String endpointUri, Object body);</tt>.
      </p>
      
<p>
        The <tt>CamelContext</tt> is determined by the <tt>camel.context.id</tt> attribute value.
        If, however, the attribute value is blank, then the first found <tt>CamelContext</tt> is used by default.
        The <tt>endpointUri</tt> is determined by the <tt>camel.endpoint.uri</tt> attribute value, and
        the <tt>body</tt> is set to the <tt>org.onehippo.repository.scheduling.RepositoryJobExecutionContext</tt> instance.
      </p>
      
<p>
        If you want to configure a Camel Repository Scheduler Job Component to invoke an endpoint URI like 'direct:processCamelRepositoryJob' for instance,
        then you can configure the following repository job in the repository
        (in the following example, it is assumed that you configure this job under a new job group named 'camel-demo'):
      </p>
      
<div class="brush: xml">
      
<div class="source"><pre class="prettyprint linenums">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;sv:node sv:name=&quot;camel-demo&quot; xmlns:sv=&quot;http://www.jcp.org/jcr/sv/1.0&quot;&gt;
  &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
    &lt;sv:value&gt;hipposched:jobgroup&lt;/sv:value&gt;
  &lt;/sv:property&gt;
  &lt;sv:node sv:name=&quot;ExampleSimpleCamelJob&quot;&gt;
    &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
      &lt;sv:value&gt;hipposched:repositoryjob&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:property sv:multiple=&quot;true&quot; sv:name=&quot;hipposched:attributeNames&quot; sv:type=&quot;String&quot;&gt;
      &lt;sv:value&gt;camel.endpoint.uri&lt;/sv:value&gt;
      &lt;sv:value&gt;camel.context.id&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:property sv:multiple=&quot;true&quot; sv:name=&quot;hipposched:attributeValues&quot; sv:type=&quot;String&quot;&gt;
      &lt;sv:value&gt;direct:processCamelRepositoryJob&lt;/sv:value&gt;
      &lt;sv:value/&gt;
    &lt;/sv:property&gt;
    &lt;sv:property sv:name=&quot;hipposched:repositoryJobClass&quot; sv:type=&quot;String&quot;&gt;
      &lt;sv:value&gt;org.onehippo.forge.camel.scheduling.DefaultCamelRepositoryJob&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:node sv:name=&quot;hipposched:triggers&quot;&gt;
      &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
        &lt;sv:value&gt;hipposched:triggers&lt;/sv:value&gt;
      &lt;/sv:property&gt;
      &lt;sv:node sv:name=&quot;ExampleSimpleCamelJobTrigger&quot;&gt;
        &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
          &lt;sv:value&gt;hipposched:crontrigger&lt;/sv:value&gt;
        &lt;/sv:property&gt;
        &lt;sv:property sv:multiple=&quot;true&quot; sv:name=&quot;jcr:mixinTypes&quot; sv:type=&quot;Name&quot;&gt;
          &lt;sv:value&gt;mix:lockable&lt;/sv:value&gt;
        &lt;/sv:property&gt;
        &lt;sv:property sv:name=&quot;jcr:uuid&quot; sv:type=&quot;String&quot;&gt;
          &lt;sv:value&gt;48f45526-542c-482b-b17e-b20bdc210ca6&lt;/sv:value&gt;
        &lt;/sv:property&gt;
        &lt;sv:property sv:name=&quot;hipposched:cronExpression&quot; sv:type=&quot;String&quot;&gt;
          &lt;sv:value&gt;0 * * * * ?&lt;/sv:value&gt;
        &lt;/sv:property&gt;
        &lt;sv:property sv:name=&quot;hipposched:nextFireTime&quot; sv:type=&quot;Date&quot;&gt;
          &lt;sv:value&gt;2015-03-23T15:35:00.000-04:00&lt;/sv:value&gt;
        &lt;/sv:property&gt;
      &lt;/sv:node&gt;
    &lt;/sv:node&gt;
  &lt;/sv:node&gt;
&lt;/sv:node&gt;
      </pre></div>
      </div>
      
<p>
        And, you will need to include the file in hippoecm-extension.xml like the following example
        (assuming the above XML is contained in configuration/modules/camel-demo-scheduler-jobs.xml):
      </p>
      
<div class="brush: xml">
      
<div class="source"><pre class="prettyprint linenums">
  &lt;sv:node sv:name=&quot;myhippoproject-camel-demo-scheduler-jobs&quot;&gt;
    &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
      &lt;sv:value&gt;hippo:initializeitem&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:property sv:name=&quot;hippo:contentresource&quot; sv:type=&quot;String&quot;&gt;
      &lt;sv:value&gt;configuration/modules/camel-demo-scheduler-jobs.xml&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:property sv:name=&quot;hippo:contentroot&quot; sv:type=&quot;String&quot;&gt;
      &lt;sv:value&gt;/hippo:configuration/hippo:modules/scheduler/hippo:moduleconfig&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:property sv:name=&quot;hippo:sequence&quot; sv:type=&quot;Double&quot;&gt;
      &lt;sv:value&gt;30060&lt;/sv:value&gt;
    &lt;/sv:property&gt;
  &lt;/sv:node&gt;
      </pre></div>
      </div>
      
<p>
        So, if the Camel route is defined like the following example,
        then whenever the scheduler job is invoked, it will simple leave a log with the body object:
      </p>
      
<div class="brush: xml">
      
<div class="source"><pre class="prettyprint linenums">
  &lt;camelContext id=&quot;myCamelContext&quot; xmlns=&quot;http://camel.apache.org/schema/spring&quot;&gt;

    &lt;!-- SNIP --&gt;

    &lt;route&gt;
      &lt;from uri=&quot;direct:processCamelRepositoryJob&quot; /&gt;
      &lt;!-- Leave log. --&gt;
      &lt;to uri=&quot;log:org.onehippo.forge.camel.demo?level=INFO&quot;/&gt;
    &lt;/route&gt;

    &lt;!-- SNIP --&gt;

  &lt;/camelContext&gt;
      </pre></div>
      </div>
    </div>

  

            </div>
        </div>
    </div>

    <hr/>

    <footer>
                <div class="container-fluid">
                <div class="row span12">Copyright &copy;                                                2017.
                        All Rights Reserved.            
                                        
            </div>

        
        
                </div>
    </footer>
</body>
</html>
