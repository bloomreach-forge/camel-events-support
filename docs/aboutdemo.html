<!DOCTYPE html>
    <!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2018-11-09 
 | Rendered using BloomReach Forge Maven Skin 3.0.1 based on Apache Maven Fluido Skin
-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                  <meta name="Date-Revision-yyyymmdd" content="20181109" />
              <meta http-equiv="Content-Language" content="en" />
      <title>Apache Camel - Hippo Events Support Documentation &#x2013; About Demo Project for Apache Camel - Hippo Event Bus Support</title>
  <link rel="stylesheet" href="./css/forge-maven-skin-syntaxhighlighter-3.0.1.min.css"/>
  <link rel="stylesheet" href="./css/forge-maven-skin-3.0.1.min.css"/>
  <link rel="stylesheet" href="./css/site.css" />
  <link rel="stylesheet" href="./css/print.css" media="print" />
  <link rel="icon" type="image/png" href="./images/skin/logo_64.png" sizes="64x64">

  
  <script type="text/javascript" src="./js/forge-maven-skin-syntaxhighlighter-3.0.1.min.js"></script>
  <script type="text/javascript" src="./js/forge-maven-skin-3.0.1.min.js"></script>

    </head>
<body class="topBarDisabled">
                        <a href="https://github.com/bloomreach-forge/camel-events-support">
    <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
         src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
         alt="Fork me on GitHub">
  </a>
          <div class="container-fluid">
  <div id="banner">
    <div id="logo">
      <a href="http://www.github.com/bloomreach-forge">
        <img src="./images/skin/logo.png" alt="BloomReach Forge Logo" />
      </a>
    </div>
    <div class="pull-left">              <div id="bannerLeft">    <h1>Camel Hippo Event Bus Support</h1>
    </div>
              </div>
    <div class="pull-right"></div>
    <div class="clear"><hr/></div>
  </div>

  <div id="breadcrumbs">
    <div class="links">
      <a href="https://developers.bloomreach.com">developers.bloomreach.com</a>
      <a href="https://www.onehippo.org">onehippo.org</a>
    </div>
    <ul class="breadcrumb">
    
  <li id="publishDate">published: 2018-11-09  
  </li>
  
        
            </ul>
    <div class="clear"><hr/></div>
  </div>
<div class="row-fluid">
  <div id="leftColumn" class="span2">
    <div class="well sidebar-nav">
    
    <ul class="nav nav-list">
            <li class="nav-header">Home</li>
              <li>  <a href="index.html" title="Home">  <span class="none"></span>  Home</a>  </li>
        <li>  <a href="release-notes.html" title="Release Notes">  <span class="none"></span>  Release Notes</a>  </li>
                  <li class="nav-header">Usage</li>
              <li>  <a href="component-hippoevent.html" title="Hippo Event Component">  <span class="none"></span>  Hippo Event Component</a>  </li>
        <li>  <a href="component-reposchedjob.html" title="Hippo Repository Scheduler Job Component">  <span class="none"></span>  Hippo Repository Scheduler Job Component</a>  </li>
        <li>  <a href="util-camelcontextutils.html" title="Utils: CamelContextUtils">  <span class="none"></span>  Utils: CamelContextUtils</a>  </li>
                  <li class="nav-header">Demo</li>
              <li class="active">  <a href="#"><span class="none"></span>About Demo Project</a>
  </li>
        <li>  <a href="demo-solr-integration.html" title="Demo 1: Solr Search Engine Integration">  <span class="none"></span>  Demo 1: Solr Search Engine Integration</a>  </li>
        <li>  <a href="demo-es-integration.html" title="Demo 2: ElasticSearch Engine Integration">  <span class="none"></span>  Demo 2: ElasticSearch Engine Integration</a>  </li>
        <li>  <a href="demo-integration-activemq.html" title="Demo 3: Running with ActiveMQ">  <span class="none"></span>  Demo 3: Running with ActiveMQ</a>  </li>
                  <li class="nav-header">Presentations and Blogs</li>
              <li>  <a href="http://www.onehippo.org/labs/integrating-hippo-cms-with-elastic-search-engine.html" class="externalLink" title="Integrating Hippo CMS with elasticsearch Engine">  <span class="none"></span>  Integrating Hippo CMS with elasticsearch Engine</a>  </li>
                  <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                          <li>  <a href="project-info.html" title="Project Information">  <span class="icon-chevron-right"></span>  Project Information</a>  </li>
                                                                                                  <li>  <a href="project-reports.html" title="Project Reports">  <span class="icon-chevron-right"></span>  Project Reports</a>  </li>
        </ul>
    
          <hr />
      <div id="poweredBy">
                <div class="clear"></div>
                <div class="clear"></div>
                <div class="clear"></div>
                <div class="clear"></div>
              <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">  <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />  </a>
          </div>
    </div>
  </div>
  <div id="bodyColumn"  class="span10" >
    
  

    <div class="section">
<h2><a name="About_Demo_Project_for_Apache_Camel_-_Hippo_Event_Bus_Support"></a>About Demo Project for Apache Camel - Hippo Event Bus Support</h2>

      
<div class="section">
<h3><a name="Problems_Overview"></a>Problems Overview</h3>
        
<p>
          <b>Apache Camel - Hippo Event Bus Support</b> component provides proper solutions
          for the architectural needs where you should update data in the external system
          on document events (such as publication/depublication) in Hippo CMS system.
        </p>
        
<p>
          The external systems may include the following in practice:
        </p>
        
<ul>
          
<li>Enterprise Search Engine (which has existed for search needs, integrating various systems)</li>
          
<li>Content Caching Services (which requires proper cache invaliation calls by other systems)</li>
          
<li>and more</li>
        </ul>
        
<p>
          The most popular scenario is integrating with the existing Enterprise Search Engine.
          Hippo CMS is required to update search index data based on document publication/depublication events mostly,
          as shown in the diagram below.
        </p>
        <img src="images/use_cases_overview1.png" alt="Use Cases Overview" />
        
<p>
          If you implement an event listener registered to <a class="externalLink" href="http://www.onehippo.org/library/concepts/hippo-services/event-bus.html" target="_blank">Hippo Event Bus</a>,
          then it should look like almost the same as the diagram shown above.
          The event listener can probably invoke the external search engine (e.g, through either REST service or direct API call)
          directly in this approach.
        </p>
        
<p>
          However, this approach could bring the following architectural questions:
        </p>
        
<ul>
          
<li>
            If the external system becomes unavailable at some moment for some reasons,
            then it may lose the event messages. How can we guarantee all the events processed?
            <b>Reliability</b> matters.
          </li>
          
<li>
            If invocations on the external search engine may take longer than expected at some moment
            for some reasons, then it may affect the performance (e.g, response time) 
            in the CMS Frontend Application and the user experiences.
            How can we avoid this? <b>Performance</b> matters.
          </li>
          
<li>
            We would like to focus only on our business logic instead of spending time on 
            learning and maintaining <a class="externalLink" href="http://www.onehippo.org/library/concepts/hippo-services/event-bus.html" target="_blank">Hippo Event Bus</a>
            event listeners implementation in  Java ourselves.
            Also, we might want to be able to change the event processing 
            steps much faster in the future (e.g, get the job done within less than 2 hours 
            to add e-mail notification task in the event processing steps).
            <b>Modifiability</b> matters.
          </li>
          
<li>
            We would like to monitor the event processing and be able to manage it 
            (e.g, turning it on/off). If we implement event listener Java code ourselves 
            for the features, then it would increase complexity a lot. 
            How can we achieve that? <b>Manageability</b> matters.
          </li>
          
<li>and more</li>
        </ul>
        
<p>
          <b>Apache Camel - Hippo Event Bus Support</b> component is now provided to answer all those questions properly.
        </p>
      </div>

      
<div class="section">
<h3><a name="Solutions_Overview"></a>Solutions Overview</h3>
        
<p>
          This demo project shows real solutions for the following scenarios:
        </p>
        
<ul>
          
<li><a href="demo-solr-integration.html">Demo 1: Solr Search Engine Integration</a></li>
          
<li><a href="demo-es-integration.html">Demo 2: ElasticSearch Search Engine Integration</a></li>
          
<li><a href="demo-integration-activemq.html">Demo 3: Running with ActiveMQ</a></li>
        </ul>
        
<p>
          The first demo shows integration with an Apache Solr search engine (as embedded as war).
          It is recommended to see this example first because it doesn't require any other software installation and configuration.
        </p>
        
<p>
          The second demo shows the same integration approach as the first scenario, but with ElasticSearch engine
          instead of Apache Solr search engine.
        </p>
        
<p>
          The third demo shows integration with either Apache Solr or ElasticSearch engine
          with using ActiveMQ as message queueing solution instead of file-based inbox folder polling.
        </p>

        
<p>
          Basically solutions are really simple thanks to Apache Camel and
          <b><a href="component-hippoevent.html">hippoevent:</a></b> Apache Camel component.
        </p>
        
<p>
          The idea in this demo project is to configure two Camel routes:
        </p>
        
<ul>
          
<li>
            one for storing HippoEventBus event into either a file in the designated folder or a message in the designated message queue.
          </li>
          
<li>
            the other for invoking the specified REST service URL based on the (file or message queue) message.
          </li>
        </ul>

        
<p>
          Depending on the real use cases, you can configure more advanced complex routes (such as parallel, translation, etc),
          but the fundamental idea here is 'store first and forward later'.
        </p>

        
<p>
          An activity flow diagram in swimlanes would help understand this point:
        </p>
        
<p>
          <img src="images/hippo-event-flow.png" alt="Hippo Event Flow" />
        </p>
        
<p>
          In the first route (either 'Route-HippoEventBus-to-File' or 'Route-HippoEventBus-to-Queue' in this demo project),
          <a href="component-hippoevent.html"><b>hippoevent:</b></a> component receives HippoEventBus event and converts it into a JSONObject.
          And, the next component (either '<a class="externalLink" href="http://camel.apache.org/file2.html"><b>file:</b></a>'
          or '<a class="externalLink" href="http://camel.apache.org/activemq.html"><b>activemq:</b></a>' component in this demo project)
          in the route stores the JSON message into either file inbox folder or designated message queue.
        </p>
        
<p>
          <img src="images/route1-small.png" alt="The first route" />
        </p>
        
<p>
          <i>Note: </i>
          With the default running mode, the first component simply stores a Hippo Event into
          a JSON file in 'inbox' file folder.
          With ActiveMQ running mode, the first stores a Hippo Event into
          a JSON message in 'hippo' message queue instead.
        </p>

        
<p>
          In the second route (either 'Route-File-to-REST' or 'REST-Queue-to-REST' in this demo project),
          a Camel component either polls a file from the inbox folder or receives a message from the designated message queue.
          And, the next component ('<a class="externalLink" href="http://camel.apache.org/http4.html"><b>http4:</b></a>' in this demo project) makes an HTTP request to the designated REST service URL
          in order to either index a document or delete a document in the external search engine.
        </p>
        
<p>
          <img src="images/route2-file2-small.png" alt="The second route" />
        </p>
        
<p>
          <i>Note: </i>
          With ActiveMQ running mode, the first component is replaced by 'from:activemq:hippo'
          in order to receive event messages from a message queue named 'hippo' in this demo project.
        </p>

        
<p>
          With this approach, you can fulfill the following quality attributes:
        </p>
        
<ul>
          
<li>
            <b>Reliability</b>:
            even if the external system becomes unavailable at some moment for some reasons,
            you don't lose any event message
            because all the failed messages are stored under either the designated folder or the designated message queue.
          </li>
          
<li>
            <b>Performance</b>:
            by separating the process to multiple routes (store first and forward later),
            you can let the second route poll or receive the message and process asynchronously).
            This approach minimizes the impact on Hippo CMS/Repository performance.
          </li>
          
<li>
            <b>Modifiability</b>:
            all the event processing is basically configured and executed by Apache Camel Context.
            You can configure any enterprise message integration patterns by leveraging various Apache Camel components.
            You can focus on your business logic.
            In this demo project, it is either <a class="externalLink" href="https://github.com/bloomreach-forge/camel-events-support/tree/master/demo/site/src/main/java/org/onehippo/forge/camel/demo/rest/services/SolrRestUpdateResource.java" target="_blank">SolrRestUpdateResource</a>
            or <a class="externalLink" href="https://github.com/bloomreach-forge/camel-events-support/tree/master/demo/site/src/main/java/org/onehippo/forge/camel/demo/rest/services/ElasticSearchRestUpdateResource.java" target="_blank">ElasticSearchRestUpdateResource</a>
            (each of which is implemented as HST REST service to create a SITE link and invoked by a 'http4' component
            in the second route to update the search engine index data).
          </li>
          
<li>
            <b>Manageability</b>:
            you can take advantage of Apache Camel monitoring tool such as <a class="externalLink" href="http://hawt.io/" target="_blank">Hawtio</a>.
            You can monitor the process, pause, stop and start a route, for instance.
          </li>
        </ul>

      </div>

      
<div class="section">
<h3><a name="Build_Demo_Project"></a>Build Demo Project</h3>
        
<p>
          You can build and install the module first with Maven.
        </p>
        
<div class="brush: bash">
        
<div class="source"><pre>
$ mvn clean install
        </pre></div>
        </div>
        
<p>
          Now you can build and run the demo project from the submodule 'demo' with Maven and
          run the demo applications locally with Maven Cargo Plugin (Apache Tomcat embedded).
        </p>
        
<div class="brush: bash">
        
<div class="source"><pre>
$ cd demo
$ mvn clean package
$ mvn -P cargo.run
        </pre></div>
        </div>
      </div>

      
<div class="section">
<h3><a name="Web_Applications_in_Demo_Project"></a>Web Applications in Demo Project</h3>
        
<p>
          If you run the Demo project, then you will see the following web applications by default:
        </p>
        
<ul>
          
<li><b>CMS (/cms)</b>: Hippo CMS Content Production Web Application</li>
          
<li><b>SITE (/site)</b>: Hippo CMS Content Delivery Web Application</li>
          
<li>
            <b>Hawtio (/hawtio)</b>: <a class="externalLink" href="http://hawt.io/" target="_blank">Web console for managing
            your Java stuff (including Camel, Tomcat, JMX, etc)</a>
          </li>
          
<li><b>Solr (/solr)</b>: <a class="externalLink" href="http://lucene.apache.org/solr/" target="_blank">Apache Solr</a> Search Engine Web Application</li>
        </ul>
      </div>

    </div>

  

    </div>
    </div>
    </div>
    <hr/>
    <footer>
    <div class="container-fluid">
      <div class="row-fluid">
          <p class="copyright">Copyright &copy;      2018.
  BloomReach Inc. All rights reserved.
</p>
    </div>
            </div>
  </footer>
    </body>
</html>

